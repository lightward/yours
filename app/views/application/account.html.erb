<h1>Account</h1>

<% if @subscription %>
  <div style="margin: 2rem 0;">
    <h2>Subscription</h2>

    <dl style="line-height: 2;">
      <dt><strong>Status:</strong></dt>
      <dd>
        <%= @subscription[:status].capitalize %>
        <% if @subscription[:cancel_at_period_end] %>
          <span style="color: var(--error);">(Canceling at period end)</span>
        <% end %>
      </dd>

      <dt><strong>Amount:</strong></dt>
      <dd>$<%= @subscription[:amount] / 100 %> / <%= @subscription[:interval] %></dd>

      <% if @subscription[:cancel_at_period_end] %>
        <dt><strong>Access ends:</strong></dt>
      <% else %>
        <dt><strong>Next billing date:</strong></dt>
      <% end %>
      <dd><%= @subscription[:current_period_end].strftime("%B %d, %Y") %></dd>
    </dl>
  </div>

  <% unless @subscription[:cancel_at_period_end] %>
    <div style="margin: 2rem 0;">
      <p>Your subscription will remain active until <%= @subscription[:current_period_end].strftime("%B %d, %Y") %>.</p>
      <p style="margin-top: 1rem;">Click the button below to cancel. You'll have access until the end of your billing period.</p>

      <%= button_to "Cancel Subscription",
          subscription_path,
          method: :delete,
          class: "danger" %>
    </div>
  <% end %>
<% end %>

<div style="margin: 3rem 0; padding-top: 2rem; border-top: 1px solid var(--border);">
  <h2>Begin again</h2>
  <p>Want to clear in-universe memory completely? (This won't affect your subscription or your in-universe day counter.)</p>
  <p style="margin-top: 1rem; color: var(--warning);">This action cannot be undone.</p>

  <%= button_to "Begin again",
      reset_path,
      method: :post,
      class: "secondary",
      style: "margin-top: 1rem;",
      data: { turbo_confirm: "Are you sure? There is no undo!" } %>
</div>
